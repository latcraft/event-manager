language: java
jdk:
  - oraclejdk8
install:
  - pip install awscli
before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  - pip
  - directories:
     - $HOME/.gradle/caches/
     - $HOME/.gradle/wrapper/
script: ./gradlew build
notifications:
  slack:
    secure: JGVJuVx0A+GoqXGyobPC3ye++lZrOZtV7+c2qegQ+BdwfIrsUW9CIRg+Dq+hgPDDMUl2cU5KYtv5OEkklaMw4dQTLKyuD4FtT2aOCKbmgonYsawbD1dY8svuqhdzUpl+RpDTjh7OILAhGR1xGM7/7ogXwRiKqb+blu/mq/BjApckTm5HbIoCy4N41cMZhUzjzX5R+HIwn4Pajp1QKWiETXuIqtjEtkQosgtzD5mdo/tOKxQVCHnnvnVBwPF518JfQ4Qv49uUzYyErLn4IZ7/h8cPjR+usS61wmGGD04HVvBs98iAlPP11ncYprAEnd61m4q054oeesycKTy554maK56M9Lkgfii1HzT2abKZQx+MmzcJys8Fq97YR+frA+DS0LsTbYxXqZ6QPIkKDGC9tMl/BABXZkMQWfE2NAgEW3VhnPNGztEGTzZfCl9jVAVZ2biqbVmnjd9iAAfT0ZWycqzu5LkepfwOOBb3jSizsYPTxGVJBhhMHaNsa2WY5syDiM6hJbHSMNJ7bv1j3z3on0xC8qk+DL0rHK5d7XGawU24AvnQ6YgI+zQwIa3TomKKJdiE+iNVzibN8s8P5ULQYq/6dI1jKgzZAxbnKVwnUKOGod1kjLtb6aVKLwpWQUmJANEXo8TyqBivAoacAnHXEO4KMq9avQRA14KFnNErU1Q=
deploy:
  - provider: s3
    skip_cleanup: true
    region: eu-west-1
    bucket: latcraft-code
    access_key_id:
      secure: oLva3uLIQc+LeiwuSBDj5WOiI85+lpzFzZu2RGmUTXuDlpKrN6TW7Qfuc8xURRnWkqXaKi0v5Ph51L+ZRpWovBU3eo5cp9OMIhp0wmkF4gasXlApxlCzIicUEt7U/k+DgyUKGtAvPSDwQW36tuPeVYdjOAv5HnzWq884MZTCe56hSvVQb8ryVIvW36MD6oDOdVuWIeZW/m0S567EI6KzfJimStAUFc/CrOZFRi61s3QkCvTnW/zSPboJaWJzmapFqdALfSpoPblqimmekdCcssKLrwy3mW2lw4e3OmAD5V8EhpcGFh0bRFg62Vmlh4yge+qqWf5JdIGK1L0DPFxbNf0cZq9Pkf+8uI1YjVH6AD0AtaqKjS+9TMbxptjpp37F5OsiOFHuPwXhfHu1XjyXQEDAEKNh9l4AS+qOAID8hQG5gc4i3mnVFiDQokSxoQ0b4eq15uf2+/e9I3EjuQpixrpJRpV0JSu3YaJiv4JG4sQ/TMclp9jFIRwllrT4vp6EslXMPEXpn7vm8Fk+1nGGEuaH06vwbl4tSMbYpu+hudHd7O8yZW+p0yvqBy4+3X5tbt5toUf+QsyNJzUrHQ/xGTyfD+Lt+XwVkrjuY5LlhReDBvIzE5//i3HRY8kXERsVDjDvWppI35lzeIKz0ot1xMkZCYvph9DImYQ9XVhuV0k=
    secret_access_key:
      secure: EfiCOHgCQYAjalVCjgmkByAIHU58HxvDe5ziJPdoIFOwAnUCqAiCa66/y9Yn5mnJROGxsIw1Sw/p2a8McbJnKvxbAVxdZ2hfycG4Yud/R/w1R7056LbbEZ5MLedWPBzA5u3aqjSh2dREu8sI7LBrng/9HARBzYAMvRPn3+Zv/27JmTeY3KoJ1jDMoxHLFEy9yDaz1pwivMDsCFV24Ldvsq92zbeBkKWrlKF3AQE+z8JNKZqhIan46siQ3NAwDN9uXRdSfSL0aLtQc7qWFdoJAGc2CLRz0CDqkjaDWGkVPgkxA+FdWO3Exw90NlNFerQYMYMCN7myledAa+A1xGnaPgV0jd71K7HAS13nBsfO2s+b5UbjxouYXc4BPlijkR+3pMkPweXLnSla3xk1piQpjyuzdiOxmNO95BppWGDDVqou3dwwtqyvprL5RJFqURMwmT8Rr5upAU7B8VJGaM2UKnW2Qp7RJqBjeqqoRAgeyrJB8kOImOq2hlRS38Us8tY9AUcdJivfM97ef+iD0dEP1xZubxqEvgFvDvFOBJZQAtI+k7eQU1c1diYsql/XPaiGckdGOe6bgvD/09C5hTJJq8LwL4/RT90SlBc3oe7BmVkd2GBvOBIWSPVIBDM8ohmy6YsW32RH3QISIWUredvPXiHhVM8XfcHtPcC5dgK+mRE=
    local_dir: build/distributions
    acl: public_read
    on:
      repo: latcraft/event-manager
after_success:
  - "aws lambda invoke --invocation-type RequestResponse --function-name auto_update_latcraft_functions --region eu-west-1 --log-type Tail --payload '{\"functions\": [\"publish_cards_function\"]}' update_response.txt\""

